<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Image2PDF & Format Converter — محول الصور الاحترافي مجاناً إلى PDF و JPG و PNG | 30+ Formats Converter</title>
<meta name="description" content="محول صور مجاني وسريع يعمل مباشرة في المتصفح. تحويل الصور إلى PDF، JPG، PNG، WebP، وغيرها من 30 صيغة بدقة عالية، مع الحفاظ على خصوصية بياناتك."/>

<meta name="keywords" lang="ar" content="تحويل صور الى pdf, محول صور مجاني, تغيير صيغ الصور, محول jpg الى png, تحويل الصور اونلاين, تحويل صورة الى pdf, jpg إلى pdf, png إلى pdf, webp إلى jpg, تحويل صيغ الصور مجانا, افضل محول صور, ضغط صور لـ pdf, دمج صور في pdf, تعديل حجم صور لـ pdf, محول صيغ, محول صور احترافي, برنامج تحويل صور, تحويل صورة الى jpg, تحويل صورة الى png, تحويل صورة الى webp, تحويل صورة الى gif, تحويل صورة الى tiff, تحويل صورة الى bmp, تحويل صور HEIC, تحويل الصور المكسيكية, تحويل صور برازيلية, تحميل محول صور, محول صور سريعة, تحويل صور بدون انترنت, محول محلي للصور, تحويل الصور للطباعة, محول صور عالية الجودة, تحويل صيغة jpg, تحويل صيغة png, محول الصور الشامل, ملفات متعددة الى pdf, محول تنسيق الصور, تحويل الصور الى وثيقة, محول صور ضغط عالي, محول صور احترافي مجاني, تحويل الصور الرقمية, محول الكتروني للصور, تحويل الصور بدون برامج, تحويل الصور للويب, افضل اداة تحويل صور, محول صور اون لاين, تحويل صور ذات جودة عالية, أداة تحويل الصور"/>

<meta name="keywords" lang="en" content="image to pdf converter, free image converter, change image format, jpg to png converter, convert images online, image to pdf free, jpg to pdf, png to pdf, webp to jpg, convert image formats for free, best image converter, compress images to pdf, merge images into pdf, resize images for pdf, format converter, professional image converter, image conversion tool, convert image to jpg, convert image to png, convert image to webp, convert image to gif, convert image to tiff, convert image to bmp, convert HEIC images, fast image converter, online image conversion tool, high-quality image converter, local image conversion, offline image converter, convert images for printing, batch image converter, multiple files to pdf, image format changer, convert images to document, high-compression image converter, free professional image converter, digital image converter, web image converter, best image conversion utility, online photo converter, high-resolution image conversion, image tool, convert photo to pdf, change picture format, free online tool"/>

<meta name="keywords" lang="ru" content="конвертер изображений в pdf, бесплатный конвертер изображений, изменить формат изображения, конвертировать jpg в png, конвертировать изображения онлайн, jpg в pdf, png в pdf, webp в jpg, конвертер форматов фото, лучший конвертер картинок, сжать картинки в pdf, объединить изображения в pdf, конвертер heic, конвертировать фото бесплатно, конвертер онлайн"/>

<meta name="keywords" lang="es" content="convertidor de imagen a pdf, conversor de fotos gratis, cambiar formato de imagen, convertir jpg a png, convertir imágenes en línea, jpg a pdf, png a pdf, webp a jpg, conversor de formatos de imagen, mejor conversor de imágenes, comprimir fotos a pdf, unir imágenes en pdf, convertir heic, herramienta de conversión de fotos, conversor gratuito en línea"/>

<meta name="keywords" lang="de" content="bild zu pdf konverter, kostenloser bildkonverter, bildformat ändern, jpg zu png konvertieren, bilder online konvertieren, jpg zu pdf, png zu pdf, webp zu jpg, bildformat konverter, bester bildkonverter, bilder zu pdf komprimieren, bilder in pdf zusammenfügen, heic konverter, kostenlose bildkonvertierung"/>

<meta name="keywords" lang="hi" content="छवि को पीडीएफ कनवर्टर, मुफ्त छवि कनवर्टर, छवि प्रारूप बदलें, जेपीईजी से पीएनजी कनवर्ट करें, छवियों को ऑनलाइन कनवर्ट करें, जेपीईजी से पीडीएफ, पीएनजी से पीडीएफ, वेबपी से जेपीईजी, फोटो प्रारूप कनवर्टर, सर्वश्रेष्ठ छवि कनवर्टर, छवियों को पीडीएफ में संपीड़ित करें"/>

<meta name="keywords" lang="zh" content="图片转pdf转换器, 免费图片转换器, 更改图片格式, jpg转png, 在线图片转换, jpg转pdf, png转pdf, webp转jpg, 图像格式转换器, 最佳图片转换工具, 压缩图片为pdf, heic转换器, 免费在线图片转换"/>

<meta name="keywords" lang="fr" content="convertisseur image en pdf, convertisseur de photos gratuit, changer format image, convertir jpg en png, convertir images en ligne, jpg en pdf, png en pdf, webp en jpg, meilleur convertisseur d'images, compresser images en pdf, fusionner images en pdf, convertisseur heic, outil de conversion de photos en ligne"/>

<meta name="keywords" lang="pt-br" content="conversor de imagem para pdf, conversor de fotos grátis, mudar formato de imagem, converter jpg para png, converter imagens online, jpg para pdf, png para pdf, webp para jpg, melhor conversor de imagem, comprimir imagens para pdf, juntar fotos em pdf, conversor heic, ferramenta de conversão de imagens"/>

<meta name="keywords" lang="es-mx" content="convertidor de foto a pdf, conversor de imagenes gratis, cambiar formato de foto, convertir jpg a png, convertir fotos en línea, jpg a pdf, png a pdf, webp a jpg, mejor conversor de fotos, comprimir imagenes a pdf, juntar fotos en pdf, convertidor heic, herramienta de conversion de imagenes"/>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLMDJ8d/T/YpWJ8/H95lR/v3A/T+d/h9vE5cK5Ff5A/c/F4gR4J3gX2vG7I5B8Q==" crossorigin="anonymous" referrerpolicy="no-referrer" />

<style>
  :root{
    --bg1:#111111;
    --bg2:#000000;
    --card:#1a1a1a;
    --accent:#ffffff;
    --muted:#aaaaaa;
    --glass: rgba(255,255,255,0.05);
    --success:#10b981;
    --danger:#fb7185;
    --border: rgba(255,255,255,0.1);
    --hover-bg: rgba(255,255,255,0.08);
  }
  html:lang(en) { direction: ltr; }
  html:lang(en) body { font-family: "Roboto", sans-serif; }
  html:lang(ar) body { font-family: "Cairo", sans-serif; }
  *{box-sizing:border-box}
  body{
    margin:0; background:linear-gradient(180deg,var(--bg1),var(--bg2));
    color:var(--accent); -webkit-font-smoothing:antialiased; min-height:100vh;
    display:flex; align-items:flex-start; justify-content:center; padding:28px;
  }
  .app {
    width:100%; max-width:1100px; border-radius:14px;
    background:var(--glass);
    box-shadow: 0 10px 40px rgba(0,0,0,0.8); padding:22px; overflow:hidden;
    border:1px solid var(--border);
  }
  header{
    display:flex; gap:18px; align-items:center; justify-content:space-between; margin-bottom:18px;
  }
  .brand {display:flex; align-items:center}
  .logo{
    width:52px; height:52px; border-radius:10px; background:var(--accent);
    display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--bg2);font-size:18px;
    box-shadow:0 6px 18px rgba(0,0,0,0.4);
    overflow: hidden; padding: 2px;
  }
  .logo img {
      width: 100%; height: 100%; object-fit: contain; border-radius: 8px;
  }
  h1{font-size:20px;margin:0;color:var(--accent)}
  p.lead{margin:0;color:var(--muted);font-size:13px}
  .lang-toggle {
    background:var(--card); color:var(--accent); border:1px solid var(--border);
    padding:8px 12px; border-radius:8px; cursor:pointer; font-size:14px; font-weight:600;
    transition: background 0.2s;
  }
  .lang-toggle:hover { background:var(--hover-bg); }
  .main { display:grid; grid-template-columns: 420px 1fr; gap:20px; }
  .panel {
    background:var(--card); border-radius:12px; padding:16px; border:1px solid var(--border);
  }
  .tabs {display:flex; gap:8px; margin-bottom:12px}
  .tab{
    flex:1; padding:10px 12px; border-radius:8px; cursor:pointer; text-align:center; font-weight:600;
    background:transparent; color:var(--muted); border:1px solid var(--border);
    transition: all 0.2s;
  }
  .tab:hover{ background:var(--hover-bg); color:var(--accent)}
  .tab.active{ background:var(--hover-bg); color:var(--accent); border-color:var(--accent)}
  label.field{display:block; font-size:13px; color:var(--muted); margin-top:10px}
  select, input[type=text], button, input[type=range]{
    width:100%; padding:10px 12px; border-radius:8px; border:1px solid var(--border);
    background:var(--bg1); color:inherit; margin-top:8px; font-size:14px;
    appearance: none;
  }
  .file-input-wrapper {
    position: relative; overflow: hidden; display: block; margin-top: 8px;
    border:1px dashed var(--muted); border-radius:8px;
  }
  .file-input-wrapper input[type=file] {
    position: absolute; left: 0; top: 0; opacity: 0; cursor: pointer; height: 100%; width: 100%;
  }
  .file-input-wrapper span {
    display: block; padding: 10px 12px; text-align: center; color: var(--muted); font-size: 14px;
    background: var(--bg1);
  }
  .row{display:flex; gap:10px}
  .row > *{flex:1}
  button.primary{
    background:var(--accent); color:var(--bg2); padding:12px; font-weight:700;
    border:none; cursor:pointer; margin-top:12px; border-radius:10px;
    transition: background 0.2s, color 0.2s;
  }
  button.primary:hover{ background:var(--muted); }
  button.ghost{
    background:var(--card); border:1px solid var(--border); color:var(--accent);
    transition: background 0.2s;
  }
  button.ghost:hover{ background:var(--hover-bg); }
  .note{font-size:13px;color:var(--muted);margin-top:10px}
  .preview {
    background:var(--card);
    border-radius:12px; padding:16px; min-height:400px; border:1px solid var(--border);
  }
  .preview-head{display:flex; justify-content:space-between; align-items:center; margin-bottom:12px}
  .thumbs { display:flex; flex-wrap:wrap; gap:12px; }
  .thumb {
    width:120px; height:120px; border-radius:8px; overflow:hidden; position:relative; background:var(--bg1);
    border:1px solid var(--border); display:flex; align-items:center; justify-content:center;
    cursor:grab;
  }
  .thumb img{width:100%; height:100%; object-fit:cover}
  .thumb .meta {
    position:absolute; left:6px; bottom:6px; background:rgba(0,0,0,0.6); padding:4px 6px; border-radius:6px; font-size:11px;
    color:var(--accent);
  }
  .thumb .remove {
    position:absolute; right:6px; top:6px; background:rgba(255,255,255,0.1); color:var(--accent); padding:4px; border-radius:6px; font-size:12px; cursor:pointer;
    line-height: 1;
  }
  .thumb .remove:hover { background:var(--danger); }
  .icon-text-seprator {margin-inline-end: 6px;}
  .controls-row{display:flex; gap:10px; margin-top:12px}
  .small{font-size:13px;color:var(--muted)}
  footer{margin-top:18px; color:var(--muted); font-size:13px; text-align:center}

  /* ===================== */
  /* التعديلات لشاشات الهاتف */
  /* ===================== */
  @media (max-width:900px){
    body { padding: 16px; }
    .app { padding: 16px; }
    
    header {
      flex-direction: column; /* جعل العناصر تترتب فوق بعضها */
      align-items: flex-start; /* محاذاة العناصر إلى البداية */
      gap: 12px;
    }
    .main{
      grid-template-columns:1fr; /* عمود واحد فقط */
    }
    .panel{order:2} /* لوحة التحكم تظهر ثانيًا */
    .preview{order:1} /* المعاينة تظهر أولًا */

    /* جعل الصفوف تتحول إلى أعمدة */
    .row, .controls-row {
      flex-direction: column;
    }

    h1 { font-size: 18px; }
    p.lead { font-size: 12px; }
    
    .thumbs {
        justify-content: center; /* توسيط الصور المصغرة */
    }

    /* تعديل بسيط على حجم الصور المصغرة إذا لزم الأمر */
    .thumb {
        width: 100px;
        height: 100px;
    }
  }

  /* تحسينات إضافية للشاشات الصغيرة جدًا */
  @media (max-width: 480px) {
    body { padding: 8px; }
    .app { padding: 12px; }
    
    .preview-head {
      flex-direction: column;
      align-items: flex-start;
      gap: 10px;
    }

    .tab {
        font-size: 12px; /* تصغير خط التبويبات */
        padding: 8px 10px;
    }
  }
/* تنسيق زر تسجيل الدخول الجديد */
.google-login-btn {
  /* لضمان محاذاة النص والأيقونة */
  display: flex; 
  align-items: center;
  justify-content: center;
  gap: 8px; /* مسافة بين الأيقونة والنص */
  
  /* التنسيق الأساسي للزر */
  background: var(--accent); /* اللون الأبيض */
  color: var(--bg2); /* النص باللون الأسود */
  padding: 10px 18px; 
  border-radius: 8px; 
  font-weight: 600; 
  cursor: pointer;
  font-size: 14px;
  border: 1px solid var(--border); /* إضافة حد خفيف */
  transition: background 0.2s, opacity 0.2s;
}

.google-login-btn:hover {
  background: var(--muted); /* لون رمادي فاتح عند التمرير */
}

/* الأيقونة المدمجة عبر SVG data URL */
.google-icon {
  width: 18px; 
  height: 18px;
  /* ⚠️ يجب التأكد من عدم وجود background-image أو background-size هنا */
}
/* تعديل بسيط لضمان محاذاة الشعار الأصلي بعد حذف العنوان */
.brand {
  display: flex; 
  align-items: center;
  /* يمكنك إعادة إضافة gap: 12px; هنا إذا أردت مسافة بين الشعار وزر جوجل */
  gap: 12px;
}

/* تنسيق الموبايل */
@media (max-width:900px){
  .google-login-btn {
      width: 100%; /* اجعل الزر يملأ العرض في الموبايل */
  }
}
/* ====================================
     الأنماط الجديدة للملف الشخصي ورصيد الكريستال
     ==================================== */
     
  /* قاعدة لإخفاء العناصر قبل تسجيل الدخول */
  .hidden { 
    display: none !important; 
  }

  /* تنسيق قسم الملف الشخصي ككل */
  .user-profile {
    display: flex; 
    gap: 10px; 
    align-items: center;
    background: var(--glass); 
    padding: 8px 12px; 
    border-radius: 20px;
    border: 1px solid var(--border);
  }
  
  /* تنسيق صورة الملف الشخصي */
  .profile-pic {
    width: 36px; 
    height: 36px; 
    border-radius: 50%; 
    object-fit: cover;
    border: 2px solid var(--success);
  }
  
  /* محاذاة الاسم ورصيد الكريستال عمودياً */
  .user-info {
    display: flex; 
    flex-direction: column; 
    line-height: 1.2;
    align-items: flex-start;
  }
  
  /* تنسيق الاسم */
  .user-name {
    color: var(--accent); 
    font-weight: 600; 
    font-size: 14px;
    max-width: 100px; 
    white-space: nowrap; 
    overflow: hidden; 
    text-overflow: ellipsis;
  }
  
  /* تنسيق رصيد الكريستال */
  .crystal-balance {
    display: flex; 
    align-items: center; 
    gap: 4px; 
    font-size: 13px;
  }
  .crystal-icon {
    width: 16px; 
    height: 16px;
  }
  
  /* التدرج اللوني لعدد الكريستال (بنفسجي متدرج مع الأزرق) */
  .crystal-count {
    font-weight: 700;
    /* تحديد التدرج اللوني */
    background: linear-gradient(45deg, #a855f7, #6366f1, #3b82f6); 
    /* تطبيق التدرج على النص */
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    color: transparent; 
  }
  
  /* تنسيق زر تسجيل الخروج */
  .logout-btn {
    background: none; 
    border: none; 
    color: var(--danger);
    font-size: 20px; 
    cursor: pointer; 
    transition: color 0.2s;
    padding: 0 5px; 
    margin-left: 5px;
  }
  .logout-btn:hover {
    color: #ff0000;
  }
  
  /* تنسيق زر تسجيل الدخول (لضمان مظهره إذا لم يكن موجوداً) */
  .google-login-btn {
    display: flex; align-items: center; justify-content: center; gap: 10px;
    background: var(--accent); color: var(--bg2); padding: 8px 15px;
    border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 14px;
    border: 1px solid var(--border); text-decoration: none;
  }
</style>
</head>
<body>
  <div class="app" role="application" aria-label="محول الصور">
    <header>
  <div class="brand">
    <div class="logo">
      <img src="https://i.ibb.co/zVQsZmHc/oe65gjzyswh7cuymlwqpu9tvc.webp" alt="Image2PDF Logo - محول الصور" loading="lazy">
    </div>
    
    <a href="login.html" class="google-login-btn" id="preLoginBtn" title="تسجيل الدخول عبر جوجل">
      <img src="https://i.ibb.co/TqWpJLw9/1.png" alt="Google Icon" class="google-icon">
      <span>تسجيل الدخول عبر جوجل</span>
    </a>
     <div id="userProfile" style="display: none; align-items: center; gap: 15px;">
    <img id="userAvatar" src="" alt="Avatar" style="width: 40px; height: 40px; border-radius: 50%;">
    <div style="color: white; font-weight: bold;" id="userName"></div>
    <div style="display: flex; align-items: center; gap: 5px;">
        <img src="https://i.ibb.co/FjbHMVk/5a35b404eb18.png" alt="Crystal" style="width: 18px; height: 18px;">
        <span id="crystalCount" style="font-weight: 700; background: linear-gradient(45deg, #a855f7, #3b82f6); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">20</span>
    </div>
    <button id="logoutBtn" style="background: var(--danger-color); color: white; border: none; padding: 8px 12px; border-radius: 8px; cursor: pointer; font-weight: bold;">خروج</button>
</div>
    <div class="user-profile hidden" id="userProfileSection">
        <img src="" alt="صورة المستخدم" class="profile-pic" id="profilePic">
        <div class="user-info">
            <span class="user-name" id="userName">الاسم</span> 
            <div class="crystal-balance">
                <img src="https://i.ibb.co/FjbHMVk/5a35b404eb18.png" alt="كريستال" class="crystal-icon">
                <span class="crystal-count" id="crystalCount">20</span>
            </div>
        </div>
        
        <button class="logout-btn" id="logoutBtn" title="تسجيل الخروج">
            <i class="fas fa-sign-out-alt"></i>
        </button>
    </div>
    
  </div>
  <div class="meta" style="display:flex; gap:10px; align-items:center;">
    
    <a href="pro.html" class="google-login-btn hidden" id="upgradeBtn" style="background: #4dabf7; color: #000; padding: 8px 10px; text-decoration: none;">
        <i class="fas fa-crown"></i> 
        <span data-key="upgradeProText">الترقية إلى Pro</span>
    </a>
    
    <button class="lang-toggle" id="langToggle">
      <span id="langFlag">🇬🇧</span> <span id="langText">English</span>
    </button>
    <div class="small" data-key="version">النسخة: <strong>1.0</strong></div>
</div>
</header>
    <div class="main">
      <div class="panel" aria-hidden="false">
        <div class="tabs" role="tablist">
          <div class="tab active" data-tab="pdf" data-key="tabPdf">الميزات الرئيسية: تحويل إلى PDF</div>
          <div class="tab" data-tab="convert" data-key="tabConvert">خدمة إضافية: تغيير ترميز الصور</div>
        </div>

        <div class="tab-content" id="pdf">
          <label class="field" data-key="labelPdfFiles"><i class="fas fa-folder-open icon-text-seprator"></i> رفع صور (متعدد) — اسحب وأسقط أو اختر من الجهاز</label>
          <div class="file-input-wrapper">
              <input id="pdfFiles" type="file" accept="image/*" multiple>
              <span data-key="chooseFileBtn">اختر الملفات...</span>
          </div>

          <div class="row">
            <div>
              <label class="field" data-key="labelPageSize"><i class="fas fa-ruler-combined icon-text-seprator"></i> حجم الصفحة</label>
              <select id="pageSize">
                <option value="a4">A4</option>
                <option value="letter">Letter</option>
                <option value="auto" data-key="autoOpt">تلقائي حسب الصورة</option>
              </select>
            </div>
            <div>
              <label class="field" data-key="labelOrientation"><i class="fas fa-compass icon-text-seprator"></i> اتجاه الصفحة</label>
              <select id="orientation">
                <option value="p" data-key="portraitOpt">عمودي (Portrait)</option>
                <option value="l" data-key="landscapeOpt">أفقي (Landscape)</option>
                <option value="auto" data-key="autoOpt">تلقائي</option>
              </select>
            </div>
          </div>

          <label class="field" data-key="labelQuality"><i class="fas fa-compress-alt icon-text-seprator"></i> ضغط وجودة الصور داخل PDF (0 = أقل جودة، 1 = أعلى جودة)</label>
          <input id="qualityRange" type="range" min="0.2" max="1" step="0.05" value="0.9">

          <div class="controls-row">
            <button class="primary" id="convertPdfBtn" data-key="convertPdfBtn"><i class="fas fa-rocket icon-text-seprator"></i> تحويل إلى PDF</button>
            <button class="ghost" id="clearPdfBtn" data-key="clearBtn"><i class="fas fa-broom icon-text-seprator"></i> مسح الصور</button>
          </div>

          <div class="note" data-key="notePrivacy">ملاحظة: التحويل يتم محليًا داخل متصفح المستخدم للحفاظ على الخصوصية.</div>
        </div>

        <div class="tab-content" id="convert" style="display:none">
          <label class="field" data-key="labelConvFiles"><i class="fas fa-image icon-text-seprator"></i> اختر صورة أو صور (لتحويل الصيغة)</label>
          <div class="file-input-wrapper">
              <input id="convFiles" type="file" accept="image/*" multiple>
              <span data-key="chooseFileBtn">اختر الملفات...</span>
          </div>

          <label class="field" data-key="labelTargetFormat"><i class="fas fa-exchange-alt icon-text-seprator"></i> اختر الصيغة الهدف (يمكنك اختيار واحد أو أكثر)</label>
          <select id="targetFormat" multiple size="6" title="يمكنك اختيار واحد أو أكثر">
            <option value="image/jpeg">JPG / JPEG</option>
            <option value="image/png">PNG</option>
            <option value="image/webp">WebP</option>
            <option value="image/avif">AVIF</option>
            <option value="image/gif">GIF</option>
            <option value="image/bmp">BMP</option>
            <option value="image/tiff">TIFF</option>
            <option value="image/x-icon">ICO</option>
            <option value="image/svg+xml">SVG</option>
            <option value="image/heic">HEIC</option>
            <option value="image/heif">HEIF</option>
            <option value="application/pdf">PDF</option>
            <option value="image/vnd.adobe.photoshop">PSD (Not standard, but common)</option>
            <option value="image/jp2">JPEG 2000 (JP2)</option>
            <option value="image/jpx">JPEG 2000 (JPX)</option>
            <option value="image/x-portable-pixmap">PPM</option>
            <option value="image/x-portable-graymap">PGM</option>
            <option value="image/x-portable-bitmap">PBM</option>
            <option value="image/x-cmu-raster">RAS</option>
            <option value="image/x-rgb">RGB</option>
            <option value="image/vnd.dwg">DWG (Not standard)</option>
            <option value="image/vnd.dxf">DXF (Not standard)</option>
            <option value="image/vnd.wap.wbmp">WBMP</option>
            <option value="image/x-freehand">FH</option>
            <option value="image/x-mrsid-image">SID</option>
            <option value="image/cgm">CGM</option>
            <option value="image/cis-cod">COD</option>
            <option value="image/vnd.fujixerox.edmics-mmr">MMR</option>
            <option value="image/vnd.net-fpx">FPX</option>
            <option value="image/vnd.ms-modi">MDI</option>
          </select>

          <label class="field" data-key="labelConvName"><i class="fas fa-file-signature icon-text-seprator"></i> اسم الملف الناتج (سيتم إضافة لاحقة الصيغة تلقائيًا)</label>
          <input id="convName" type="text" placeholder="مثلاً: my-converted-image">

          <div class="controls-row">
            <button class="primary" id="convertFormatBtn" data-key="convertFormatBtn"><i class="fas fa-sync-alt icon-text-seprator"></i> تحويل الصيغ المحددة</button>
            <button class="ghost" id="clearConvBtn" data-key="clearBtn"><i class="fas fa-broom icon-text-seprator"></i> مسح</button>
          </div>

          <div class="note" data-key="noteConvSupport">ملاحظة: بعض الصيغ تعتمد على دعم المتصفح. إن لم يدعم المتصفح الصيغة، سيظهر إشعار يطلب تجربة صيغ أخرى (مثل JPG أو PNG).</div>
        </div>
      </div>

      <div class="preview" id="previewArea" aria-live="polite">
        <div class="preview-head">
          <div>
            <strong id="previewTitle" data-key="previewTitle">معاينة الصور</strong>
            <div class="small" id="previewCount" data-key="previewCountEmpty">لم يتم رفع صور بعد</div>
          </div>
          <div>
            <button class="ghost" id="downloadAllBtn" data-key="downloadAllBtn"><i class="fas fa-download icon-text-seprator"></i> تنزيل كل النتائج</button>
          </div>
        </div>

        <div class="thumbs" id="thumbs"></div>

        <div id="statusMsg" class="note" style="margin-top:12px"></div>
      </div>
    </div>

    <footer data-key="footer">© 2025 Image2PDF — جميع الحقوق محفوظة</footer>
  </div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
/* ======= Utilities & State ======= */
const el = id => document.getElementById(id);
const $thumbs = el('thumbs');
const state = { filesPdf: [], filesConv: [], lang: 'ar' };

/* ======= Translation Data ======= */
const translations = {
  ar: {
    appName: 'Image2PDF — محول الصور الاحترافي',
    appTagline: 'خدمة محلية في المتصفح — تحويل إلى PDF & تغيير ترميز الصور',
    version: 'النسخة: 1.0',
    upgradeProText: 'الترقية إلى Pro'
    tabPdf: 'الميزات الرئيسية: تحويل إلى PDF',
    tabConvert: 'خدمة إضافية: تغيير ترميز الصور',
    labelPdfFiles: 'رفع صور (متعدد) — اسحب وأسقط أو اختر من الجهاز',
    labelPageSize: 'حجم الصفحة',
    labelOrientation: 'اتجاه الصفحة',
    autoOpt: 'تلقائي حسب الصورة',
    portraitOpt: 'عمودي (Portrait)',
    landscapeOpt: 'أفقي (Landscape)',
    labelQuality: 'ضغط وجودة الصور داخل PDF (0 = أقل جودة، 1 = أعلى جودة)',
    convertPdfBtn: 'تحويل إلى PDF',
    clearBtn: 'مسح',
    notePrivacy: 'ملاحظة: التحويل يتم محليًا داخل متصفح المستخدم للحفاظ على الخصوصية.',
    labelConvFiles: 'اختر صورة أو صور (لتحويل الصيغة)',
    chooseFileBtn: 'اختر الملفات...',
    labelTargetFormat: 'اختر الصيغة الهدف (يمكنك اختيار واحد أو أكثر)',
    labelConvName: 'اسم الملف الناتج (سيتم إضافة لاحقة الصيغة تلقائيًا)',
    convertFormatBtn: 'تحويل الصيغ المحددة',
    noteConvSupport: 'ملاحظة: بعض الصيغ تعتمد على دعم المتصفح. إن لم يدعم المتصفح الصيغة، سيظهر إشعار يطلب تجربة صيغ أخرى (مثل JPG أو PNG).',
    previewTitle: 'معاينة الصور',
    previewCountEmpty: 'لم يتم رفع صور بعد',
    previewCount: (count) => `عدد الصور: ${count}`,
    downloadAllBtn: 'تنزيل كل النتائج',
    statusNoFiles: '⚠️ الرجاء رفع صور أولاً.',
    statusPdfConverting: '⏳ جاري التحويل إلى PDF...',
    statusPdfDone: '✅ تم إنشاء ملف PDF وتنزيله.',
    statusPdfError: (err) => `❌ حدث خطأ أثناء التحويل: ${err}`,
    statusConvStart: '⏳ جاري تحويل الصيغ...',
    statusConvNoFormat: '⚠️ الرجاء اختيار صيغة واحدة على الأقل.',
    statusConvDone: '✅ انتهى التحويل. الملفات تم تنزيلها (إذا سمح المتصفح).',
    statusConvFormatError: (fmt) => `⚠️ المتصفح لا يدعم التحويل إلى ${fmt}. جرّب صيغة أخرى (مثل JPG أو PNG).`,
    statusConvError: (err) => `❌ خطأ أثناء تحويل الصيغ: ${err}`,
    statusClearedPdf: 'تم مسح صور PDF.',
    statusClearedConv: 'تم مسح صور التحويل.',
    statusDownloadNote: 'ملاحظة: التنزيل التلقائي متاح للنتائج حالما تكون جاهزة بعد التحويل.',
    statusWelcome: 'مرحباً! اختر تبويب الخدمة ثم ارفع صورك. يمكنك سحب الصور لإعادة ترتيبها.',
    placeholderConvName: 'مثلاً: my-converted-image',
    footer: '© 2025 Image2PDF — جميع الحقوق محفوظة',
    langFlag: '🇬🇧',
    langText: 'English'
  },
  en: {
    appName: 'Image2PDF — Professional Image Converter',
    appTagline: 'Local Browser Service — Convert to PDF & Image Format Encoding',
    version: 'Version: 1.0',
    upgradeProText: 'Upgrade to Pro'
    tabPdf: 'Key Feature: Convert to PDF',
    tabConvert: 'Extra Service: Image Format Conversion',
    labelPdfFiles: 'Upload Images (Multi) — Drag and Drop or Choose from Device',
    labelPageSize: 'Page Size',
    labelOrientation: 'Page Orientation',
    autoOpt: 'Auto (Based on Image)',
    portraitOpt: 'Portrait',
    landscapeOpt: 'Landscape',
    labelQuality: 'Image Compression & Quality in PDF (0 = Lowest, 1 = Highest)',
    convertPdfBtn: 'Convert to PDF',
    clearBtn: 'Clear',
    notePrivacy: 'Note: Conversion is done locally within your browser to ensure privacy.',
    labelConvFiles: 'Choose Image(s) (For Format Conversion)',
    chooseFileBtn: 'Choose Files...',
    labelTargetFormat: 'Select Target Format (You can choose one or more)',
    labelConvName: 'Output File Name (Format suffix will be added automatically)',
    convertFormatBtn: 'Convert Selected Formats',
    noteConvSupport: 'Note: Some formats depend on browser support. If not supported, an alert will ask you to try other formats (e.g., JPG or PNG).',
    previewTitle: 'Image Preview',
    previewCountEmpty: 'No images uploaded yet',
    previewCount: (count) => `Image Count: ${count}`,
    downloadAllBtn: 'Download All Results',
    statusNoFiles: '⚠️ Please upload images first.',
    statusPdfConverting: '⏳ Converting to PDF...',
    statusPdfDone: '✅ PDF file created and downloaded.',
    statusPdfError: (err) => `❌ Error during conversion: ${err}`,
    statusConvStart: '⏳ Converting Formats...',
    statusConvNoFormat: '⚠️ Please select at least one format.',
    statusConvDone: '✅ Conversion complete. Files downloaded (if allowed by browser).',
    statusConvFormatError: (fmt) => `⚠️ Browser does not support conversion to ${fmt}. Try another format (like JPG or PNG).`,
    statusConvError: (err) => `❌ Error during format conversion: ${err}`,
    statusClearedPdf: 'PDF images cleared.',
    statusClearedConv: 'Conversion images cleared.',
    statusDownloadNote: 'Note: Automatic download is available for results once conversion is ready.',
    statusWelcome: 'Welcome! Select the service tab, then upload your images. You can drag images to reorder them.',
    placeholderConvName: 'e.g.: my-converted-image',
    footer: '© 2025 Image2PDF — All Rights Reserved',
    langFlag: '🇸🇦',
    langText: 'Arabic'
  }
};

function applyTranslation(lang) {
  const t = translations[lang];
  document.documentElement.lang = lang;
  document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';

  document.querySelectorAll('[data-key]').forEach(el => {
    const key = el.dataset.key;
    if (t[key]) {
      if (el.tagName === 'INPUT' && el.type === 'text') {
        el.placeholder = t[key];
      } else {
        el.textContent = typeof t[key] === 'function' ? t[key](0) : t[key];
      }
    }
  });

  el('langFlag').textContent = t.langFlag;
  el('langText').textContent = t.langText;
  
  const currentFiles = document.querySelector('.tab.active').dataset.tab === 'pdf' ? state.filesPdf : state.filesConv;
  el('previewCount').textContent = currentFiles.length ? t.previewCount(currentFiles.length) : t.previewCountEmpty;
  
  el('statusMsg').textContent = t.statusWelcome;
  el('convName').placeholder = t.placeholderConvName;
}

el('langToggle').addEventListener('click', () => {
  state.lang = state.lang === 'ar' ? 'en' : 'ar';
  applyTranslation(state.lang);
});

/* ======= Tabs ======= */
document.querySelectorAll('.tab').forEach(t => {
  t.addEventListener('click', () => {
    document.querySelectorAll('.tab').forEach(x => x.classList.remove('active'));
    t.classList.add('active');
    const tab = t.dataset.tab;
    document.querySelectorAll('.tab-content').forEach(c => c.style.display = c.id === tab ? '' : 'none');
    el('statusMsg').textContent = translations[state.lang].statusWelcome;
    
    // Render correct thumbs for the active tab
    renderThumbs(tab === 'pdf' ? state.filesPdf : state.filesConv);
  });
});

/* ======= File inputs handlers ======= */
function handleFileChange(ev, fileType) {
    const files = Array.from(ev.target.files);
    state[fileType] = files;
    renderThumbs(files);

    const span = ev.target.nextElementSibling;
    const t = translations[state.lang];
    if (files.length) {
        span.textContent = files.length > 1
            ? `${files.length} ${state.lang === 'ar' ? 'ملفات مختارة' : 'files selected'}`
            : files[0].name;
    } else {
        span.textContent = t.chooseFileBtn;
    }
}

el('pdfFiles').addEventListener('change', (ev) => handleFileChange(ev, 'filesPdf'));
el('convFiles').addEventListener('change', (ev) => handleFileChange(ev, 'filesConv'));

/* ======= Render thumbnails ======= */
function renderThumbs(list) {
  $thumbs.innerHTML = '';
  const t = translations[state.lang];
  const activeTab = document.querySelector('.tab.active').dataset.tab;
  const currentListKey = activeTab === 'pdf' ? 'filesPdf' : 'filesConv';

  if (!list || list.length === 0) {
    el('previewCount').textContent = t.previewCountEmpty;
    return;
  }
  el('previewCount').textContent = t.previewCount(list.length);
  
  list.forEach((file, idx) => {
    const box = document.createElement('div');
    box.className = 'thumb';
    box.draggable = true;
    box.dataset.index = idx;
    
    const imgEl = document.createElement('img');
    const reader = new FileReader();
    reader.onload = e => { imgEl.src = e.target.result; };
    reader.readAsDataURL(file);

    const meta = document.createElement('div');
    meta.className = 'meta';
    meta.textContent = file.name.split('.').pop().toUpperCase();

    const rem = document.createElement('div');
    rem.className = 'remove';
    rem.innerHTML = '<i class="fas fa-times"></i>';
    rem.title = state.lang === 'ar' ? 'إزالة' : 'Remove';
    rem.onclick = (ev) => {
      ev.stopPropagation();
      list.splice(idx,1);
      state[currentListKey] = [...list];
      
      const fileInputId = activeTab === 'pdf' ? 'pdfFiles' : 'convFiles';
      const fileInputWrapperSelector = `#${activeTab} .file-input-wrapper span`;

      el(fileInputId).value = ''; // Clear file input
      document.querySelector(fileInputWrapperSelector).textContent = t.chooseFileBtn;
      
      renderThumbs(list);
    };

    box.appendChild(imgEl);
    box.appendChild(meta);
    box.appendChild(rem);
    $thumbs.appendChild(box);
  });

  enableDragReorder(list);
}

/* ======= Drag reorder ======= */
function enableDragReorder(list){
  let dragSrc = null;
  $thumbs.querySelectorAll('.thumb').forEach(t => {
    t.addEventListener('dragstart', (e) => { dragSrc = e.currentTarget; e.dataTransfer.effectAllowed = 'move'; });
    t.addEventListener('dragover', (e) => { e.preventDefault(); });
    t.addEventListener('drop', (e) => {
      e.preventDefault();
      const target = e.currentTarget.closest('.thumb');
      if (!target || !dragSrc || target === dragSrc) return;
      
      const srcIndex = +dragSrc.dataset.index;
      const tgtIndex = +target.dataset.index;
      
      [list[srcIndex], list[tgtIndex]] = [list[tgtIndex], list[srcIndex]];
      renderThumbs(list);
    });
  });
}

/* ======= PDF conversion ======= */
el('convertPdfBtn').addEventListener('click', async () => {
  const t = translations[state.lang];
  const files = state.filesPdf;
  if (!files || files.length === 0) { el('statusMsg').textContent = t.statusNoFiles; return; }

  el('statusMsg').textContent = t.statusPdfConverting;
  const pageSize = el('pageSize').value;
  let orientation = el('orientation').value;
  const quality = parseFloat(el('qualityRange').value);

  try {
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF({ unit:'mm', format: pageSize === 'auto' ? 'a4' : pageSize, orientation: orientation === 'auto' ? 'p' : orientation });

    for (const [index, file] of files.entries()) {
        const dataURL = await fileToDataURL(file);
        const img = await loadImage(dataURL);

        let pageOrient = orientation === 'auto' ? (img.width > img.height ? 'l' : 'p') : orientation;
        
        if (index > 0) {
            pdf.addPage(pageSize === 'auto' ? [img.width, img.height] : pageSize, pageOrient);
        } else {
            // For the first page, if orientation changed, we need to re-init or adjust
            if (pdf.internal.pageSize.width < pdf.internal.pageSize.height && pageOrient === 'l') {
                pdf.internal.pageSize.width = [pdf.internal.pageSize.height, pdf.internal.pageSize.height = pdf.internal.pageSize.width][0];
            } else if (pdf.internal.pageSize.width > pdf.internal.pageSize.height && pageOrient === 'p') {
                pdf.internal.pageSize.width = [pdf.internal.pageSize.height, pdf.internal.pageSize.height = pdf.internal.pageSize.width][0];
            }
        }

        const pageW = pdf.internal.pageSize.getWidth();
        const pageH = pdf.internal.pageSize.getHeight();
        const margin = 8;
        const maxW = pageW - margin*2;
        const maxH = pageH - margin*2;

        const imgRatio = img.width / img.height;
        let drawW = maxW, drawH = maxW / imgRatio;
        if (drawH > maxH) { drawH = maxH; drawW = maxH * imgRatio; }

        const imgForPdf = await imageToDataURL(img, 'image/jpeg', quality);
        pdf.addImage(imgForPdf, 'JPEG', (pageW - drawW)/2, (pageH - drawH)/2, drawW, drawH);
    }

    pdf.save('images_converted.pdf');
    el('statusMsg').textContent = t.statusPdfDone;
  } catch (err) {
    console.error(err);
    el('statusMsg').textContent = t.statusPdfError(err.message || err);
  }
});

/* ======= Format conversion ======= */
el('convertFormatBtn').addEventListener('click', async () => {
  const t = translations[state.lang];
  const files = state.filesConv;
  if (!files || files.length === 0) { el('statusMsg').textContent = t.statusNoFiles; return; }

  const selected = Array.from(el('targetFormat').selectedOptions).map(o=>o.value);
  if (selected.length === 0) { el('statusMsg').textContent = t.statusConvNoFormat; return; }

  const baseName = el('convName').value.trim() || 'converted-image';
  el('statusMsg').textContent = t.statusConvStart;

  try {
    for (const file of files) {
      const dataURL = await fileToDataURL(file);
      const img = await loadImage(dataURL);

      for (const fmt of selected) {
        const ext = extFromMime(fmt);
        try {
          const blob = await imageToBlob(img, fmt);
          triggerDownload(blob, `${baseName}_${file.name.split('.').slice(0, -1).join('.')}.${ext}`);
        } catch (e) {
          console.warn('format unsupported:', fmt, e);
          el('statusMsg').textContent = t.statusConvFormatError(fmt.split('/').pop());
        }
      }
    }
    el('statusMsg').textContent = t.statusConvDone;
  } catch (err) {
    console.error(err);
    el('statusMsg').textContent = t.statusConvError(err.message || err);
  }
});

/* ======= Helpers ======= */
function fileToDataURL(file){ return new Promise((res,rej)=>{ const r=new FileReader(); r.onload=e=>res(e.target.result); r.onerror=rej; r.readAsDataURL(file); }); }
function loadImage(src){ return new Promise((res,rej)=>{ const img=new Image(); img.onload=()=>res(img); img.onerror=rej; img.src = src; }); }
function extFromMime(m){
    const map = {'image/jpeg':'jpg','image/png':'png','image/webp':'webp','image/avif':'avif','image/gif':'gif','image/bmp':'bmp','image/tiff':'tiff','image/x-icon':'ico','image/svg+xml':'svg','image/heic':'heic','image/heif':'heif','application/pdf':'pdf','image/vnd.adobe.photoshop': 'psd','image/jp2': 'jp2','image/jpx': 'jpx','image/x-portable-pixmap': 'ppm','image/x-portable-graymap': 'pgm','image/x-portable-bitmap': 'pbm','image/x-cmu-raster': 'ras','image/x-rgb': 'rgb','image/vnd.dwg': 'dwg','image/vnd.dxf': 'dxf','image/vnd.wap.wbmp': 'wbmp','image/x-freehand': 'fh','image/x-mrsid-image': 'sid','image/cgm': 'cgm','image/cis-cod': 'cod','image/vnd.fujixerox.edmics-mmr': 'mmr','image/vnd.net-fpx': 'fpx','image/vnd.ms-modi': 'mdi'};
    return map[m]||m.split('/').pop();
}
function imageToBlob(img, mime='image/png', quality=0.92){
  return new Promise((res,rej)=>{
    const canvas = document.createElement('canvas');
    canvas.width = img.naturalWidth || img.width;
    canvas.height = img.naturalHeight || img.height;
    const ctx = canvas.getContext('2d');
    ctx.drawImage(img,0,0);
    canvas.toBlob((blob)=>{ if(blob) res(blob); else rej(new Error('toBlob failed')); }, mime, quality);
  });
}
async function imageToDataURL(img, mime='image/jpeg', quality=0.92){
  const blob = await imageToBlob(img, mime, quality);
  return await new Promise(res => { const r=new FileReader(); r.onload=e=>res(e.target.result); r.readAsDataURL(blob); });
}
function triggerDownload(blob, filename){
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = filename; document.body.appendChild(a); a.click();
  setTimeout(()=>{ URL.revokeObjectURL(url); a.remove(); }, 1000);
}

/* ======= Clear buttons ======= */
el('clearPdfBtn').addEventListener('click', ()=>{
  const t = translations[state.lang];
  state.filesPdf = []; el('pdfFiles').value=''; renderThumbs([]);
  el('statusMsg').textContent = t.statusClearedPdf;
  document.querySelector('#pdf .file-input-wrapper span').textContent = t.chooseFileBtn;
});
el('clearConvBtn').addEventListener('click', ()=>{
  const t = translations[state.lang];
  state.filesConv = []; el('convFiles').value=''; el('convName').value=''; renderThumbs([]);
  el('statusMsg').textContent = t.statusClearedConv;
  document.querySelector('#convert .file-input-wrapper span').textContent = t.chooseFileBtn;
});

/* ======= download all btn ======= */
el('downloadAllBtn').addEventListener('click', ()=>{
  el('statusMsg').textContent = translations[state.lang].statusDownloadNote;
});

/* ======= Drag & Drop file support ======= */
const dropArea = document.querySelector('.app');
dropArea.addEventListener('dragover', e=>e.preventDefault());
dropArea.addEventListener('drop', e=>{ e.preventDefault();
  const files = Array.from(e.dataTransfer.files || []).filter(f=>f.type.startsWith('image/'));
  if(files.length > 0){
      const activeTab = document.querySelector('.tab.active').dataset.tab;
      if (activeTab === 'pdf') {
        state.filesPdf = state.filesPdf.concat(files);
        renderThumbs(state.filesPdf);
      } else {
        state.filesConv = state.filesConv.concat(files);
        renderThumbs(state.filesConv);
      }
  }
});

    const SUPABASE_URL = "https://vayuuzbcgemrlgvmktzl.supabase.co";

    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZheXV1emJjZ2Vtcmxndm1rdHpsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA0NDA4MDQsImV4cCI6MjA3NjAxNjgwNH0.yQIuNEb8QRBOaSGW0cKB8cQvPpZMWG7T_0gnufjVa0g";

    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);



    document.addEventListener('DOMContentLoaded', async () => {

        const { data: { session } } = await supabase.auth.getSession();

        updateUI(session);



        supabase.auth.onAuthStateChange((event, session) => {
    // إذا كان الحدث هو تسجيل دخول ناجح (SIGNED_IN)
    if (event === 'SIGNED_IN') {
        // انتظر لحظة قصيرة للتأكد من اكتمال الجلسة ثم انتقل إلى home.html
        setTimeout(() => {
            window.location.href = 'home.html';
        }, 100);
    } else {
        // في الحالات الأخرى (مثل تحديث الصفحة أو تسجيل الخروج)، قم فقط بتحديث الواجهة
        updateUI(session);
    }
});



    function updateUI(session) {

        const loginButton = document.querySelector('.google-login-button, #preLoginBtn, #google-sign-in-btn');

        const userProfile = document.getElementById('userProfile');



        if (session) {

            // User is logged in

            loginButton.style.display = 'none';

            userProfile.style.display = 'flex';



            const user = session.user;

            const userName = user.user_metadata?.full_name || user.email.split('@')[0];

            const userAvatar = user.user_metadata?.avatar_url || 'https://i.ibb.co/qCbQ2Yc/default-avatar.png';



            document.getElementById('userName').textContent = userName;

            document.getElementById('userAvatar').src = userAvatar;

            // Crystal count is static for now

            // document.getElementById('crystalCount').textContent = '20';



            document.getElementById('logoutBtn').onclick = async () => {

                await supabase.auth.signOut();

                window.location.reload(); // Reload to show login button again

            };

        } else {

            // User is logged out

            loginButton.style.display = 'flex';

            userProfile.style.display = 'none';

        }

    }

/* ======= On load ======= */
applyTranslation(state.lang);
</script>
</body>
</html>