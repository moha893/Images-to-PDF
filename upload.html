<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Image2PDF & Format Converter — محول الصور الاحترافي</title>
<meta name="description" content="محول صور مجاني وسريع يعمل مباشرة في المتصفح. تحويل الصور إلى PDF، JPG، PNG، WebP، وغيرها."/>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
<style>
  :root{
    --bg1:#111111; --bg2:#000000; --card:#1a1a1a; --accent:#ffffff;
    --muted:#aaaaaa; --glass: rgba(255,255,255,0.05); --success:#10b981;
    --danger:#fb7185; --border: rgba(255,255,255,0.1); --hover-bg: rgba(255,255,255,0.08);
  }
  html:lang(en) { direction: ltr; }
  html:lang(en) body { font-family: "Roboto", sans-serif; }
  html:lang(ar) body { font-family: "Cairo", sans-serif; }
  *{box-sizing:border-box}
  body{
    margin:0; background:linear-gradient(180deg,var(--bg1),var(--bg2));
    color:var(--accent); -webkit-font-smoothing:antialiased; min-height:100vh;
    display:flex; align-items:flex-start; justify-content:center; padding:28px;
  }
  .app {
    width:100%; max-width:1100px; border-radius:14px;
    background:var(--glass);
    box-shadow: 0 10px 40px rgba(0,0,0,0.8); padding:22px; overflow:hidden;
    border:1px solid var(--border);
  }
  header{
    display:flex; gap:18px; align-items:center; justify-content:space-between; margin-bottom:18px;
  }
  
  /* --- STYLES FOR LOGIN/PROFILE --- */
  .brand { display: flex; align-items: center; gap: 12px; }
  .logo { 
    width:52px; height:52px; border-radius:10px; overflow: hidden; padding: 2px; 
    display:flex; align-items:center; justify-content:center;
  }
  .logo img { width: 100%; height: 100%; object-fit: contain; border-radius: 8px; }

  #user-auth-section { flex-grow: 1; display: flex; justify-content: flex-end; align-items: center; }
  
  .login-btn {
      background-color: #4285F4; color: white; padding: 10px 20px;
      text-decoration: none; border-radius: 8px; font-weight: bold;
      transition: background-color 0.3s; white-space: nowrap;
  }
  .login-btn:hover { background-color: #357ae8; }

  .user-profile { display: flex; align-items: center; gap: 15px; }
  .profile-pic { width: 40px; height: 40px; border-radius: 50%; border: 2px solid var(--border); }
  .user-name { font-weight: bold; }
  
  .crystal-balance { 
    display: flex; align-items: center; gap: 5px; 
    background: var(--card); padding: 5px 10px; border-radius: 20px;
    border: 1px solid var(--border);
  }
  .crystal-balance img { width: 24px; height: 24px; }
  .crystal-count {
      font-weight: bold; font-size: 1.1em;
      background: linear-gradient(45deg, #8a2be2, #007bff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
  }
  
  .upgrade-btn {
      background: linear-gradient(45deg, #8e44ad, #9b59b6); color: white; padding: 8px 16px;
      text-decoration: none; border-radius: 8px; font-weight: bold;
      transition: transform 0.2s; white-space: nowrap;
  }
  .upgrade-btn:hover { transform: scale(1.05); }

  .logout-btn {
      background: var(--danger); color: white; border: none; padding: 8px 16px;
      border-radius: 8px; font-family: inherit; cursor: pointer; font-weight: bold;
      transition: background-color 0.3s;
  }
  .logout-btn:hover { background-color: #e74c3c; }

  .main { display:grid; grid-template-columns: 420px 1fr; gap:20px; }
  .panel {
    background:var(--card); border-radius:12px; padding:16px; border:1px solid var(--border);
  }
  /* Your other styles are preserved */
  .tabs{display:flex;gap:8px;margin-bottom:12px}
  .tab{flex:1;padding:10px 12px;border-radius:8px;cursor:pointer;text-align:center;font-weight:600;background:transparent;color:var(--muted);border:1px solid var(--border);transition:all .2s}
  .tab:hover{background:var(--hover-bg);color:var(--accent)}
  .tab.active{background:var(--hover-bg);color:var(--accent);border-color:var(--accent)}
  label.field{display:block;font-size:13px;color:var(--muted);margin-top:10px}
  select,input[type=text],button,input[type=range]{width:100%;padding:10px 12px;border-radius:8px;border:1px solid var(--border);background:var(--bg1);color:inherit;margin-top:8px;font-size:14px;-webkit-appearance:none;-moz-appearance:none;appearance:none}
  .file-input-wrapper{position:relative;overflow:hidden;display:block;margin-top:8px;border:1px dashed var(--muted);border-radius:8px}
  .file-input-wrapper input[type=file]{position:absolute;left:0;top:0;opacity:0;cursor:pointer;height:100%;width:100%}
  .file-input-wrapper span{display:block;padding:10px 12px;text-align:center;color:var(--muted);font-size:14px;background:var(--bg1)}
  .row{display:flex;gap:10px}
  .row>*{flex:1}
  button.primary{background:var(--accent);color:var(--bg2);padding:12px;font-weight:700;border:none;cursor:pointer;margin-top:12px;border-radius:10px;transition:background .2s,color .2s}
  button.primary:hover{background:var(--muted)}
  button.ghost{background:var(--card);border:1px solid var(--border);color:var(--accent);transition:background .2s}
  button.ghost:hover{background:var(--hover-bg)}
  .note{font-size:13px;color:var(--muted);margin-top:10px}
  .preview{background:var(--card);border-radius:12px;padding:16px;min-height:400px;border:1px solid var(--border)}
  .preview-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
  .thumbs{display:flex;flex-wrap:wrap;gap:12px}
  .thumb{width:120px;height:120px;border-radius:8px;overflow:hidden;position:relative;background:var(--bg1);border:1px solid var(--border);display:flex;align-items:center;justify-content:center;cursor:grab}
  .thumb img{width:100%;height:100%;object-fit:cover}
  .thumb .meta{position:absolute;left:6px;bottom:6px;background:rgba(0,0,0,.6);padding:4px 6px;border-radius:6px;font-size:11px;color:var(--accent)}
  .thumb .remove{position:absolute;right:6px;top:6px;background:rgba(255,255,255,.1);color:var(--accent);padding:4px;border-radius:6px;font-size:12px;cursor:pointer;line-height:1}
  .thumb .remove:hover{background:var(--danger)}
  .icon-text-seprator{margin-inline-end:6px}
  .controls-row{display:flex;gap:10px;margin-top:12px}
  .small{font-size:13px;color:var(--muted)}
  footer{margin-top:18px;color:var(--muted);font-size:13px;text-align:center}
  @media (max-width:900px){body{padding:16px}.app{padding:16px}header{flex-direction:column;align-items:stretch;gap:12px}#user-auth-section{justify-content:center;margin-top:10px}.user-profile{flex-wrap:wrap;justify-content:center}.main{grid-template-columns:1fr}.panel{order:2}.preview{order:1}.row,.controls-row{flex-direction:column}.thumbs{justify-content:center}}
  @media (max-width:480px){body{padding:8px}.app{padding:12px}.preview-head{flex-direction:column;align-items:flex-start;gap:10px}.tab{font-size:12px;padding:8px 10px}}
</style>
</head>
<body>
  <div class="app" role="application">
    <header>
      <div class="brand">
        <div class="logo">
          <img src="https://i.ibb.co/zVQsZmHc/oe65gjzyswh7cuymlwqpu9tvc.webp" alt="Logo" loading="lazy">
        </div>
      </div>
      <div id="user-auth-section">
        </div>
    </header>

    <div class="main">
      <div class="panel" aria-hidden="false">
        <div class="tabs" role="tablist">
          <div class="tab active" data-tab="pdf" data-key="tabPdf">الميزات الرئيسية: تحويل إلى PDF</div>
          <div class="tab" data-tab="convert" data-key="tabConvert">خدمة إضافية: تغيير ترميز الصور</div>
        </div>
        <div class="tab-content" id="pdf">
          <label class="field" data-key="labelPdfFiles"><i class="fas fa-folder-open icon-text-seprator"></i> رفع صور (متعدد)</label>
          <div class="file-input-wrapper">
              <input id="pdfFiles" type="file" accept="image/*" multiple>
              <span data-key="chooseFileBtn">اختر الملفات...</span>
          </div>
          <div class="row">
            <div>
              <label class="field" data-key="labelPageSize"><i class="fas fa-ruler-combined icon-text-seprator"></i> حجم الصفحة</label>
              <select id="pageSize">
                <option value="a4">A4</option>
                <option value="letter">Letter</option>
                <option value="auto" data-key="autoOpt">تلقائي</option>
              </select>
            </div>
            <div>
              <label class="field" data-key="labelOrientation"><i class="fas fa-compass icon-text-seprator"></i> اتجاه الصفحة</label>
              <select id="orientation">
                <option value="p" data-key="portraitOpt">عمودي</option>
                <option value="l" data-key="landscapeOpt">أفقي</option>
                <option value="auto" data-key="autoOpt">تلقائي</option>
              </select>
            </div>
          </div>
          <label class="field" data-key="labelQuality"><i class="fas fa-compress-alt icon-text-seprator"></i> ضغط وجودة الصور</label>
          <input id="qualityRange" type="range" min="0.2" max="1" step="0.05" value="0.9">
          <div class="controls-row">
            <button class="primary" id="convertPdfBtn" data-key="convertPdfBtn"><i class="fas fa-rocket icon-text-seprator"></i> تحويل إلى PDF</button>
            <button class="ghost" id="clearPdfBtn" data-key="clearBtn"><i class="fas fa-broom icon-text-seprator"></i> مسح</button>
          </div>
        </div>
        <div class="tab-content" id="convert" style="display:none">
            </div>
      </div>

      <div class="preview" id="previewArea">
        <div class="preview-head">
          <div>
            <strong id="previewTitle" data-key="previewTitle">معاينة الصور</strong>
            <div class="small" id="previewCount" data-key="previewCountEmpty">لم يتم رفع صور بعد</div>
          </div>
        </div>
        <div class="thumbs" id="thumbs"></div>
        <div id="statusMsg" class="note" style="margin-top:12px"></div>
      </div>
    </div>
    <footer data-key="footer">© 2025 Image2PDF — جميع الحقوق محفوظة</footer>
  </div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
    // All your existing JavaScript for PDF conversion and functionality goes here.
    // The translation part has been removed to avoid conflicts.
    const el=id=>document.getElementById(id);
    const $thumbs=el("thumbs");
    const state={filesPdf:[],filesConv:[]};
    // ...The rest of your original PDF conversion script...
    document.querySelectorAll(".tab").forEach(t=>{t.addEventListener("click",()=>{document.querySelectorAll(".tab").forEach(e=>e.classList.remove("active"));t.classList.add("active");const e=t.dataset.tab;document.querySelectorAll(".tab-content").forEach(t=>t.style.display=t.id===e?"":"none");renderThumbs("pdf"===e?state.filesPdf:state.filesConv)})});function handleFileChange(e,t){const n=Array.from(e.target.files);state[t]=n,renderThumbs(n);const l=e.target.nextElementSibling;n.length?l.textContent=1<n.length?`${n.length} files selected`:n[0].name:l.textContent="Choose Files..."}el("pdfFiles").addEventListener("change",e=>handleFileChange(e,"filesPdf")),el("convFiles").addEventListener("change",e=>handleFileChange(e,"filesConv"));function renderThumbs(e){$thumbs.innerHTML="";const t=document.querySelector(".tab.active").dataset.tab;if(el("previewCount").textContent=e&&0!==e.length?`Image Count: ${e.length}`:"No images uploaded yet",e&&0!==e.length){e.forEach((n,l)=>{const i=document.createElement("div");i.className="thumb",i.draggable=!0,i.dataset.index=l;const d=document.createElement("img"),a=new FileReader;a.onload=e=>{d.src=e.target.result},a.readAsDataURL(n);const s=document.createElement("div");s.className="meta",s.textContent=n.name.split(".").pop().toUpperCase();const c=document.createElement("div");c.className="remove",c.innerHTML='<i class="fas fa-times"></i>',c.title="Remove",c.onclick=n=>{n.stopPropagation(),e.splice(l,1),state["pdf"===t?"filesPdf":"filesConv"]=[...e];const i="pdf"===t?"pdfFiles":"convFiles",d=`#${t} .file-input-wrapper span`;el(i).value="",document.querySelector(d).textContent="Choose Files...",renderThumbs(e)},i.appendChild(d),i.appendChild(s),i.appendChild(c),$thumbs.appendChild(i)}),enableDragReorder(e)}}
    function enableDragReorder(e){let t=null;$thumbs.querySelectorAll(".thumb").forEach(n=>{n.addEventListener("dragstart",e=>{t=e.currentTarget,e.dataTransfer.effectAllowed="move"}),n.addEventListener("dragover",e=>e.preventDefault()),n.addEventListener("drop",n=>{n.preventDefault();const l=n.currentTarget.closest(".thumb");if(l&&t&&l!==t){const n=+t.dataset.index,i=+l.dataset.index;[e[n],e[i]]=[e[i],e[n]],renderThumbs(e)}})})}el("convertPdfBtn").addEventListener("click",async()=>{const e=state.filesPdf;if(e&&0!==e.length){el("statusMsg").textContent="⏳ Converting to PDF...";const t=el("pageSize").value;let n=el("orientation").value;const l=parseFloat(el("qualityRange").value);try{const{jsPDF:i}=window.jspdf,d=new i({unit:"mm",format:"auto"===t?"a4":t,orientation:"auto"===n?"p":n});for(const[a,s]of e.entries()){const e=await fileToDataURL(s),i=await loadImage(e);let c="auto"===n?i.width>i.height?"l":"p":n;0<a?d.addPage("auto"===t?[i.width,i.height]:t,c):d.internal.pageSize.width<d.internal.pageSize.height&&"l"===c?d.internal.pageSize.width=[d.internal.pageSize.height,d.internal.pageSize.height=d.internal.pageSize.width][0]:d.internal.pageSize.width>d.internal.pageSize.height&&"p"===c&&(d.internal.pageSize.width=[d.internal.pageSize.height,d.internal.pageSize.height=d.internal.pageSize.width][0]);const r=d.internal.pageSize.getWidth(),o=d.internal.pageSize.getHeight(),f=r-16,g=o-16,p=i.width/i.height;let u=f,h=f/p;h>g&&(h=g,u=g*p);const m=await imageToDataURL(i,"image/jpeg",l);d.addImage(m,"JPEG",(r-u)/2,(o-h)/2,u,h)}d.save("images_converted.pdf"),el("statusMsg").textContent="✅ PDF file created and downloaded."}catch(e){console.error(e),el("statusMsg").textContent=`❌ Error during conversion: ${e.message||e}`}}else el("statusMsg").textContent="⚠️ Please upload images first."});
    function fileToDataURL(e){return new Promise((t,n)=>{const l=new FileReader;l.onload=e=>t(e.target.result),l.onerror=n,l.readAsDataURL(e)})}function loadImage(e){return new Promise((t,n)=>{const l=new Image;l.onload=()=>t(l),l.onerror=n,l.src=e})}async function imageToDataURL(e,t="image/jpeg",n=.92){const l=await imageToBlob(e,t,n);return await new Promise(e=>{const t=new FileReader;t.onload=t=>e(t.target.result),t.readAsDataURL(l)})}
    el("clearPdfBtn").addEventListener("click",()=>{state.filesPdf=[],el("pdfFiles").value="",renderThumbs([]),el("statusMsg").textContent="PDF images cleared.",document.querySelector("#pdf .file-input-wrapper span").textContent="Choose Files..."});
    const dropArea=document.querySelector(".app");dropArea.addEventListener("dragover",e=>e.preventDefault()),dropArea.addEventListener("drop",e=>{e.preventDefault();const t=Array.from(e.dataTransfer.files||[]).filter(e=>e.type.startsWith("image/"));if(0<t.length){const e=document.querySelector(".tab.active").dataset.tab;"pdf"===e?(state.filesPdf=state.filesPdf.concat(t),renderThumbs(state.filesPdf)):(state.filesConv=state.filesConv.concat(t),renderThumbs(state.filesConv))}});
</script>

<script type="module" src="firebase-auth.js"></script>

</body>
</html>